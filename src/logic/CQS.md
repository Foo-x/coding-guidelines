# コマンドクエリ分離原則
> **CQS (Command Query Separation)**  
> メソッドをコマンドとクエリに分ける

メソッドは副作用を持つものと持たないものに分けましょう。副作用とはそのメソッドの外の状態を変化させることです。インスタンス変数の上書きや、ファイルI/Oなどがあります。

- **コマンド**: 副作用を持ち、値を返さない
- **クエリ**: 副作用を持たず、値を返す

コマンドは注意して扱う必要があります。副作用を持つということは、実行した順番によって結果が変わるからです。一方、クエリは状態を変えないので、いつ実行しても良く、順番を変えることもできます。コマンドとクエリを明確に分けることで、メソッドが使いやすくなります。


## 注意
配列の`pop`や、`Fluent setters`パターンのように、副作用を持ちながら値を返すケースがあります。これらは原則を満たしていませんが、副作用の範囲が限定的であることや、すでに多くの開発者の共通認識になっていることから、例外と言えます。基本的には原則を満たすようにしましょう。

なお、そもそも現代では、副作用を持つメソッド自体を減らしたほうが良いとされています。これは[不変性](immutability.md)とも関連します。
